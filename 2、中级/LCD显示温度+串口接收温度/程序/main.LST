C51 COMPILER V9.01   MAIN                                                                  08/29/2013 15:53:42 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: D:\Keil\C51\BIN\C51.EXE main.c BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          /*******************************************************************************
   2          *  µ—È√˚         :Œ¬∂»œ‘ æ µ—È
   3          *  π”√µƒIO       : 
   4          *  µ—È–ßπ˚       :1602œ‘ æŒ¬∂»
   5          * ◊¢“‚           £∫
   6          *******************************************************************************/
   7          
   8          #include<reg51.h>
   9          #include"lcd.h"
  10          #include"temp.h"
  11          
  12          uchar CNCHAR[6] = "…„ œ∂»";
  13          void LcdDisplay(int);
  14          void UsartConfiguration();
  15          
  16          /*******************************************************************************
  17          * ∫Ø ˝√˚         : main
  18          * ∫Ø ˝π¶ƒ‹       : ÷˜∫Ø ˝
  19          *  ‰»Î           : Œﬁ
  20          *  ‰≥ˆ           : Œﬁ
  21          *******************************************************************************/
  22          
  23          void main()
  24          {
  25   1        UsartConfiguration();
  26   1        LcdInit();       //≥ı ºªØLCD1602
  27   1        LcdWriteCom(0x88);  //–¥µÿ÷∑ 80±Ì æ≥ı ºµÿ÷∑
  28   1        LcdWriteData('C'); 
  29   1        while(1)
  30   1        {
  31   2          LcdDisplay(Ds18b20ReadTemp());
  32   2      //    Delay1ms(1000);//1s÷”À¢“ª¥Œ
  33   2        }
  34   1      }
  35          
  36          /*******************************************************************************
  37          * ∫Ø ˝√˚         : LcdDisplay()
  38          * ∫Ø ˝π¶ƒ‹       : LCDœ‘ æ∂¡»°µΩµƒŒ¬∂»
  39          *  ‰»Î           : v
  40          *  ‰≥ˆ           : Œﬁ
  41          *******************************************************************************/
  42          
  43          void LcdDisplay(int temp)    //lcdœ‘ æ
  44          {
  45   1          
  46   1          unsigned char i, datas[] = {0, 0, 0, 0, 0}; //∂®“Â ˝◊È
  47   1        float tp;  
  48   1        if(temp< 0)       //µ±Œ¬∂»÷µŒ™∏∫ ˝
  49   1          {
  50   2            LcdWriteCom(0x80);    //–¥µÿ÷∑ 80±Ì æ≥ı ºµÿ÷∑
  51   2          SBUF='-';//Ω´Ω” ’µΩµƒ ˝æ›∑≈»ÎµΩ∑¢ÀÕºƒ¥Ê∆˜
  52   2          while(!TI);              //µ»¥˝∑¢ÀÕ ˝æ›ÕÍ≥…
  53   2          TI=0;            //«Â≥˝∑¢ÀÕÕÍ≥…±Í÷æŒª
  54   2            LcdWriteData('-');      //œ‘ æ∏∫
  55   2          //“ÚŒ™∂¡»°µƒŒ¬∂» « µº Œ¬∂»µƒ≤π¬Î£¨À˘“‘ºı1£¨‘Ÿ»°∑¥«Û≥ˆ‘≠¬Î
C51 COMPILER V9.01   MAIN                                                                  08/29/2013 15:53:42 PAGE 2   

  56   2          temp=temp-1;
  57   2          temp=~temp;
  58   2          tp=temp;
  59   2          temp=tp*0.0625*100+0.5; 
  60   2          //¡Ù¡Ω∏ˆ–° ˝µ„æÕ*100£¨+0.5 «Àƒ…·ŒÂ»Î£¨“ÚŒ™C”Ô—‘∏°µ„ ˝◊™ªªŒ™’˚–Õµƒ ±∫Ú∞—–° ˝µ„
  61   2          //∫Û√Êµƒ ˝◊‘∂Ø»•µÙ£¨≤ªπ‹ «∑Ò¥Û”⁄0.5£¨∂¯+0.5÷Æ∫Û¥Û”⁄0.5µƒæÕ «Ω¯1¡À£¨–°”⁄0.5µƒæÕ
  62   2          //À„”…œ0.5£¨ªπ «‘⁄–° ˝µ„∫Û√Ê°£
  63   2       
  64   2          }
  65   1        else
  66   1          {     
  67   2            LcdWriteCom(0x80);    //–¥µÿ÷∑ 80±Ì æ≥ı ºµÿ÷∑
  68   2            LcdWriteData('+');    //œ‘ æ’˝
  69   2          SBUF='+';//Ω´Ω” ’µΩµƒ ˝æ›∑≈»ÎµΩ∑¢ÀÕºƒ¥Ê∆˜
  70   2          while(!TI);              //µ»¥˝∑¢ÀÕ ˝æ›ÕÍ≥…
  71   2          TI=0;            //«Â≥˝∑¢ÀÕÕÍ≥…±Í÷æŒª
  72   2          tp=temp;//“ÚŒ™ ˝æ›¥¶¿Ì”––° ˝µ„À˘“‘Ω´Œ¬∂»∏≥∏¯“ª∏ˆ∏°µ„–Õ±‰¡ø
  73   2          //»Áπ˚Œ¬∂» «’˝µƒƒ«√¥£¨ƒ«√¥’˝ ˝µƒ‘≠¬ÎæÕ «≤π¬ÎÀ¸±æ…Ì
  74   2          temp=tp*0.0625*100+0.5; 
  75   2          //¡Ù¡Ω∏ˆ–° ˝µ„æÕ*100£¨+0.5 «Àƒ…·ŒÂ»Î£¨“ÚŒ™C”Ô—‘∏°µ„ ˝◊™ªªŒ™’˚–Õµƒ ±∫Ú∞—–° ˝µ„
  76   2          //∫Û√Êµƒ ˝◊‘∂Ø»•µÙ£¨≤ªπ‹ «∑Ò¥Û”⁄0.5£¨∂¯+0.5÷Æ∫Û¥Û”⁄0.5µƒæÕ «Ω¯1¡À£¨–°”⁄0.5µƒæÕ
  77   2          //À„º”…œ0.5£¨ªπ «‘⁄–° ˝µ„∫Û√Ê°£
  78   2        }
  79   1        datas[0] = temp / 10000;
  80   1        datas[1] = temp % 10000 / 1000;
  81   1        datas[2] = temp % 1000 / 100;
  82   1        datas[3] = temp % 100 / 10;
  83   1        datas[4] = temp % 10;
  84   1      
  85   1        LcdWriteCom(0x82);      //–¥µÿ÷∑ 80±Ì æ≥ı ºµÿ÷∑
  86   1        LcdWriteData('0'+datas[0]); //∞ŸŒª 
  87   1        SBUF = '0'+datas[0];//Ω´Ω” ’µΩµƒ ˝æ›∑≈»ÎµΩ∑¢ÀÕºƒ¥Ê∆˜
  88   1        while (!TI);               //µ»¥˝∑¢ÀÕ ˝æ›ÕÍ≥…
  89   1        TI = 0;
  90   1        
  91   1        LcdWriteCom(0x83);     //–¥µÿ÷∑ 80±Ì æ≥ı ºµÿ÷∑
  92   1        LcdWriteData('0'+datas[1]); // ÆŒª
  93   1        SBUF = '0'+datas[1];//Ω´Ω” ’µΩµƒ ˝æ›∑≈»ÎµΩ∑¢ÀÕºƒ¥Ê∆˜
  94   1        while (!TI);               //µ»¥˝∑¢ÀÕ ˝æ›ÕÍ≥…
  95   1        TI = 0;
  96   1      
  97   1        LcdWriteCom(0x84);    //–¥µÿ÷∑ 80±Ì æ≥ı ºµÿ÷∑
  98   1        LcdWriteData('0'+datas[2]); //∏ˆŒª 
  99   1        SBUF = '0'+datas[2];//Ω´Ω” ’µΩµƒ ˝æ›∑≈»ÎµΩ∑¢ÀÕºƒ¥Ê∆˜
 100   1        while (!TI);               //µ»¥˝∑¢ÀÕ ˝æ›ÕÍ≥…
 101   1        TI = 0;
 102   1      
 103   1        LcdWriteCom(0x85);    //–¥µÿ÷∑ 80±Ì æ≥ı ºµÿ÷∑
 104   1        LcdWriteData('.');    //œ‘ æ °Æ.°Ø
 105   1        SBUF = '.';//Ω´Ω” ’µΩµƒ ˝æ›∑≈»ÎµΩ∑¢ÀÕºƒ¥Ê∆˜
 106   1        while (!TI);               //µ»¥˝∑¢ÀÕ ˝æ›ÕÍ≥…
 107   1        TI = 0;
 108   1      
 109   1        LcdWriteCom(0x86);     //–¥µÿ÷∑ 80±Ì æ≥ı ºµÿ÷∑
 110   1        LcdWriteData('0'+datas[3]); //œ‘ æ–° ˝µ„  
 111   1        SBUF = '0'+datas[3];//Ω´Ω” ’µΩµƒ ˝æ›∑≈»ÎµΩ∑¢ÀÕºƒ¥Ê∆˜
 112   1        while (!TI);               //µ»¥˝∑¢ÀÕ ˝æ›ÕÍ≥…
 113   1        TI = 0;
 114   1      
 115   1        LcdWriteCom(0x87);     //–¥µÿ÷∑ 80±Ì æ≥ı ºµÿ÷∑
 116   1        LcdWriteData('0'+datas[4]); //œ‘ æ–° ˝µ„ 
 117   1        SBUF = '0'+datas[4];//Ω´Ω” ’µΩµƒ ˝æ›∑≈»ÎµΩ∑¢ÀÕºƒ¥Ê∆˜
C51 COMPILER V9.01   MAIN                                                                  08/29/2013 15:53:42 PAGE 3   

 118   1        while (!TI);               //µ»¥˝∑¢ÀÕ ˝æ›ÕÍ≥…
 119   1        TI = 0;
 120   1        for(i=0; i<6; i++)
 121   1        {
 122   2          SBUF = CNCHAR[i];//Ω´Ω” ’µΩµƒ ˝æ›∑≈»ÎµΩ∑¢ÀÕºƒ¥Ê∆˜
 123   2          while (!TI);               //µ»¥˝∑¢ÀÕ ˝æ›ÕÍ≥…
 124   2          TI = 0;
 125   2        }
 126   1      
 127   1         
 128   1      }
 129          /*******************************************************************************
 130          * ∫Ø  ˝ √˚         :UsartConfiguration()
 131          * ∫Ø ˝π¶ƒ‹       :…Ë÷√¥Æø⁄
 132          *  ‰    »Î         : Œﬁ
 133          *  ‰    ≥ˆ         : Œﬁ
 134          *******************************************************************************/
 135          
 136          void UsartConfiguration()
 137          {
 138   1        SCON=0X50;      //…Ë÷√Œ™π§◊˜∑Ω Ω1
 139   1        TMOD=0X20;      //…Ë÷√º∆ ˝∆˜π§◊˜∑Ω Ω2
 140   1        PCON=0X80;      //≤®Ãÿ¬ º”±∂
 141   1        TH1=0XF3;       //º∆ ˝∆˜≥ı º÷µ…Ë÷√£¨◊¢“‚≤®Ãÿ¬  «4800µƒ
 142   1        TL1=0XF3;
 143   1      //  ES=1;           //¥Úø™Ω” ’÷–∂œ
 144   1      //  EA=1;           //¥Úø™◊‹÷–∂œ
 145   1        TR1=1;          //¥Úø™º∆ ˝∆˜
 146   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    437    ----
   CONSTANT SIZE    =      5    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      6      11
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
